plot
}
testRisk <- function(risk_data) {
levels = length(risk_data)
df <- do.call("rbind", risk_data)
state = levels(df$state)
title <- paste("Invasion Risk Over Time for", state)
plot <- ggplot(df, aes(time, probability, col = level))
plot <- plot + geom_point() + geom_line() + ggtitle(title)
plot <- plot + xlab("Years") + ylab("Probability[Establishment > Level]")
plot <- plot + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.border = element_blank(), panel.background = element_blank(),
legend.background = element_blank(),
axis.line.x = element_line(color = "black"),
axis.line.y = element_line(color = "black"))
plot
}
testRisk(maine_risk)
testRisk <- function(risk_data) {
levels = length(risk_data)
df <- do.call("rbind", risk_data)
state = levels(df$state)
title <- paste("Invasion Risk Over Time for", state)
plot <- ggplot(df, aes(time, probability, col = level))
plot <- plot + geom_point() + geom_line() + ggtitle(title)
plot <- plot + xlab("Years") + ylab("Probability[Establishment > Level]")
plot <- plot + theme_bw()
plot <- plot + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.border = element_blank(), panel.background = element_blank(),
legend.background = element_blank(),
axis.line.x = element_line(color = "black"),
axis.line.y = element_line(color = "black"))
plot
}
testRisk(maine_risk)
testRisk <- function(risk_data) {
levels = length(risk_data)
df <- do.call("rbind", risk_data)
state = levels(df$state)
title <- paste("Invasion Risk Over Time for", state)
plot <- ggplot(df, aes(time, probability, col = level))
plot <- plot + geom_point() + geom_line() + ggtitle(title)
plot <- plot + xlab("Years") + ylab("Probability[Establishment > Level]")
plot <- plot + theme_bw()
plot <- plot + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), legend.background = element_blank(),
axis.line.x = element_line(color = "black"),
axis.line.y = element_line(color = "black"))
plot
}
testRisk(maine_risk)
testRisk <- function(risk_data) {
levels = length(risk_data)
df <- do.call("rbind", risk_data)
state = levels(df$state)
title <- paste("Invasion Risk Over Time for", state)
plot <- ggplot(df, aes(time, probability, col = level))
plot <- plot + geom_point() + geom_line() + ggtitle(title)
plot <- plot + xlab("Years") + ylab("Probability[Establishment > Level]")
plot <- plot
plot <- plot + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), legend.background = element_blank(),
axis.line.x = element_line(colour = "black"),
axis.line.y = element_line(colour = "black"))
plot
}
testRisk(maine_risk)
testRisk <- function(risk_data) {
levels = length(risk_data)
df <- do.call("rbind", risk_data)
state = levels(df$state)
title <- paste("Invasion Risk Over Time for", state)
plot <- ggplot(df, aes(time, probability, col = level))
plot <- plot + geom_point() + geom_line() + ggtitle(title)
plot <- plot + xlab("Years") + ylab("Probability[Establishment > Level]")
plot <- plot
plot <- plot + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), legend.background = element_blank(),
axis.line.x = element_line(colour = "black"),
axis.line = element_line(colour = "black"))
plot
}
testRisk(maine_risk)
testRisk <- function(risk_data) {
levels = length(risk_data)
df <- do.call("rbind", risk_data)
state = levels(df$state)
title <- paste("Invasion Risk Over Time for", state)
plot <- ggplot(df, aes(time, probability, col = level))
plot <- plot + geom_point() + geom_line() + ggtitle(title)
plot <- plot + xlab("Years") + ylab("Probability[Establishment > Level]")
plot <- plot + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), legend.background = element_blank(),
axis.line.x = element_line(colour = "black"),
axis.line = element_line(colour = "black"),
axis.text.y = element_text(size=14, ),
axis.text.x = element_text(size=14, hjust = -0.35),
axis.title.y = element_text(size=14, vjust = 0.35),
axis.title.x = element_text(size=14))
plot
}
testRisk(maine_risk)
testRisk <- function(risk_data) {
levels = length(risk_data)
df <- do.call("rbind", risk_data)
state = levels(df$state)
title <- paste("Invasion Risk Over Time for", state)
plot <- ggplot(df, aes(time, probability, col = level))
plot <- plot + geom_point() + geom_line() + ggtitle(title)
plot <- plot + xlab("Years") + ylab("Probability[Establishment > Level]")
plot <- plot + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), legend.background = element_blank(),
axis.line.x = element_line(colour = "black"),
axis.line = element_line(colour = "black"),
axis.text.y = element_text(size=14, ),
axis.text.x = element_text(size=14, hjust = -1),
axis.title.y = element_text(size=14, vjust = 1),
axis.title.x = element_text(size=14))
plot
}
testRisk(maine_risk)
testRisk <- function(risk_data) {
levels = length(risk_data)
df <- do.call("rbind", risk_data)
state = levels(df$state)
title <- paste("Invasion Risk Over Time for", state)
plot <- ggplot(df, aes(time, probability, col = level))
plot <- plot + geom_point() + geom_line() + ggtitle(title)
plot <- plot + xlab("Years") + ylab("Probability[Establishment > Level]")
plot <- plot + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), legend.background = element_blank(),
axis.line.x = element_line(colour = "black"),
axis.line = element_line(colour = "black"),
axis.text.y = element_text(size=14, ),
axis.text.x = element_text(size=14, hjust = -1),
axis.title.y = element_text(size=14, vjust = -1),
axis.title.x = element_text(size=14))
plot
}
testRisk(maine_risk)
testRisk <- function(risk_data) {
levels = length(risk_data)
df <- do.call("rbind", risk_data)
state = levels(df$state)
title <- paste("Invasion Risk Over Time for", state)
plot <- ggplot(df, aes(time, probability, col = level))
plot <- plot + geom_point() + geom_line() + ggtitle(title)
plot <- plot + xlab("Years") + ylab("Probability[Establishment > Level]")
plot <- plot + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), legend.background = element_blank(),
axis.line.x = element_line(colour = "black"),
axis.line = element_line(colour = "black"),
axis.text.y = element_text(size=10),
axis.text.x = element_text(size=10),
axis.title.y = element_text(size=14, vjust = 1),
axis.title.x = element_text(size=14, vjust = 1)
plot
}
testRisk <- function(risk_data) {
levels = length(risk_data)
df <- do.call("rbind", risk_data)
state = levels(df$state)
title <- paste("Invasion Risk Over Time for", state)
plot <- ggplot(df, aes(time, probability, col = level))
plot <- plot + geom_point() + geom_line() + ggtitle(title)
plot <- plot + xlab("Years") + ylab("Probability[Establishment > Level]")
plot <- plot + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), legend.background = element_blank(),
axis.line.x = element_line(colour = "black"),
axis.line = element_line(colour = "black"),
axis.text.y = element_text(size=10),
axis.text.x = element_text(size=10),
axis.title.y = element_text(size=14, vjust = 1),
axis.title.x = element_text(size=14, hjust = 1)
plot
}
testRisk <- function(risk_data) {
levels = length(risk_data)
df <- do.call("rbind", risk_data)
state = levels(df$state)
title <- paste("Invasion Risk Over Time for", state)
plot <- ggplot(df, aes(time, probability, col = level))
plot <- plot + geom_point() + geom_line() + ggtitle(title)
plot <- plot + xlab("Years") + ylab("Probability[Establishment > Level]")
plot <- plot + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), legend.background = element_blank(),
axis.line.x = element_line(colour = "black"),
axis.line = element_line(colour = "black"),
axis.text.y = element_text(size=10),
axis.text.x = element_text(size=10),
axis.title.y = element_text(size=14, vjust = 1),
axis.title.x = element_text(size=14, hjust = 1))
plot
}
testRisk(maine_risk)
testRisk <- function(risk_data) {
levels = length(risk_data)
df <- do.call("rbind", risk_data)
state = levels(df$state)
title <- paste("Invasion Risk Over Time for", state)
plot <- ggplot(df, aes(time, probability, col = level))
plot <- plot + geom_point() + geom_line() + ggtitle(title)
plot <- plot + xlab("Years") + ylab("Probability[Establishment > Level]")
plot <- plot + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), legend.background = element_blank(),
axis.line.x = element_line(colour = "black"),
axis.line = element_line(colour = "black"),
axis.text.y = element_text(size=10),
axis.text.x = element_text(size=10),
axis.title.y = element_text(size=14, vjust = 1),
axis.title.x = element_text(size=14, vjust = 1))
plot
}
testRisk(maine_risk)
testRisk <- function(risk_data) {
levels = length(risk_data)
df <- do.call("rbind", risk_data)
state = levels(df$state)
title <- paste("Invasion Risk Over Time for", state)
plot <- ggplot(df, aes(time, probability, col = level))
plot <- plot + geom_point() + geom_line() + ggtitle(title)
plot <- plot + xlab("Years") + ylab("Probability[Establishment > Level]")
plot <- plot + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), legend.background = element_blank(),
axis.line.x = element_line(colour = "black"),
axis.line = element_line(colour = "black"),
axis.text.y = element_text(size=10),
axis.text.x = element_text(size=10),
axis.title.y = element_text(size=14),
axis.title.x = element_text(size=14, vjust = 1))
plot
}
testRisk(maine_risk)
testRisk <- function(risk_data) {
levels = length(risk_data)
df <- do.call("rbind", risk_data)
state = levels(df$state)
title <- paste("Invasion Risk Over Time for", state)
plot <- ggplot(df, aes(time, probability, col = level))
plot <- plot + geom_point() + geom_line() + ggtitle(title)
plot <- plot + xlab("Years") + ylab("Probability[Establishment > Level]")
plot <- plot + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), legend.background = element_blank(),
axis.line.x = element_line(colour = "black"),
axis.line = element_line(colour = "black"),
axis.text.y = element_text(size=10),
axis.text.x = element_text(size=10),
axis.title.y = element_text(size=14, vjust = 1),
axis.title.x = element_text(size=14, vjust = 1))
plot
}
testRisk(maine_risk)
testRisk <- function(risk_data) {
levels = length(risk_data)
df <- do.call("rbind", risk_data)
state = levels(df$state)
title <- paste("Invasion Risk Over Time for", state)
plot <- ggplot(df, aes(time, probability, col = level))
plot <- plot + geom_point() + geom_line() + ggtitle(title)
plot <- plot + xlab("Years") + ylab("Probability[Establishment > Level]")
plot <- plot + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), legend.background = element_blank(),
axis.line.x = element_line(colour = "black"),
axis.line = element_line(colour = "black"),
axis.text.y = element_text(size=10),
axis.text.x = element_text(size=10),
axis.title.y = element_text(size=14, vjust = .35),
axis.title.x = element_text(size=14, vjust = 1))
plot
}
testRisk(maine_risk)
testRisk <- function(risk_data) {
levels = length(risk_data)
df <- do.call("rbind", risk_data)
state = levels(df$state)
title <- paste("Invasion Risk Over Time for", state)
plot <- ggplot(df, aes(time, probability, col = level))
plot <- plot + geom_point() + geom_line() + ggtitle(title)
plot <- plot + xlab("Years") + ylab("Probability[Establishment > Level]")
plot <- plot + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), legend.background = element_blank(),
axis.line.x = element_line(colour = "black"),
axis.line = element_line(colour = "black"),
axis.text.y = element_text(size=10),
axis.text.x = element_text(size=10),
axis.title.y = element_text(size=14, vjust = 1),
axis.title.x = element_text(size=14, vjust = 1))
pl
testRisk <- function(risk_data) {
levels = length(risk_data)
df <- do.call("rbind", risk_data)
state = levels(df$state)
title <- paste("Invasion Risk Over Time for", state)
plot <- ggplot(df, aes(time, probability, col = level))
plot <- plot + geom_point() + geom_line() + ggtitle(title)
plot <- plot + xlab("Years") + ylab("Probability[Establishment > Level]")
plot <- plot + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), legend.background = element_blank(),
axis.line.x = element_line(colour = "black"),
axis.line = element_line(colour = "black"),
axis.text.y = element_text(size=10),
axis.text.x = element_text(size=10),
axis.title.y = element_text(size=14, vjust = 1),
axis.title.x = element_text(size=14, vjust = 1),
plot.title = element_text(size = 16, vjust = 1))
plot
}
testRisk(maine_risk)
)
testRisk(maine_risk)
testRisk(maine_risk)
plotRisk("Alabama", "Tennessee", 100, 30, levels = c(0.1, 0.2, 0.3, 0.4, 0.5))
testRisk <- function(risk_data) {
levels = length(risk_data)
df <- do.call("rbind", risk_data)
state = levels(df$state)
title <- paste("Invasion Risk Over Time for", state)
plot <- ggplot(df, aes(time, probability, col = level))
plot <- plot + geom_point() + geom_line() + ggtitle(title)
plot <- plot + xlab("Years") + ylab("Probability[Establishment > Level]")
plot <- plot + theme(
panel.background = element_blank(), legend.background = element_blank(),
axis.line.x = element_line(colour = "black"),
axis.line = element_line(colour = "black"),
axis.text.y = element_text(size=10),
axis.text.x = element_text(size=10),
axis.title.y = element_text(size=14, vjust = 1),
axis.title.x = element_text(size=14, vjust = 1),
plot.title = element_text(size = 16, vjust = 1))
plot
}
testRisk(maine_risk)
testRisk <- function(risk_data) {
levels = length(risk_data)
df <- do.call("rbind", risk_data)
state = levels(df$state)
title <- paste("Invasion Risk Over Time for", state)
plot <- ggplot(df, aes(time, probability, col = level))
plot <- plot + geom_point() + geom_line() + ggtitle(title)
plot <- plot + xlab("Years") + ylab("Probability[Establishment > Level]")
plot <- plot + theme(panel.grid.major = element_line(colour = "black"), panel.grid.minor = element_blank(colour = "black"),
panel.background = element_blank(), legend.background = element_blank(),
axis.line.x = element_line(colour = "black"),
axis.line = element_line(colour = "black"),
axis.text.y = element_text(size=10),
axis.text.x = element_text(size=10),
axis.title.y = element_text(size=14, vjust = 1),
axis.title.x = element_text(size=14, vjust = 1),
plot.title = element_text(size = 16, vjust = 1))
plot
}
testRisk(maine_risk)
testRisk <- function(risk_data) {
levels = length(risk_data)
df <- do.call("rbind", risk_data)
state = levels(df$state)
title <- paste("Invasion Risk Over Time for", state)
plot <- ggplot(df, aes(time, probability, col = level))
plot <- plot + geom_point() + geom_line() + ggtitle(title)
plot <- plot + xlab("Years") + ylab("Probability[Establishment > Level]")
plot <- plot + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), legend.background = element_blank(),
axis.line.x = element_line(colour = "black"),
axis.line = element_line(colour = "black"),
axis.text.y = element_text(size=10),
axis.text.x = element_text(size=10),
axis.title.y = element_text(size=14, vjust = 1),
axis.title.x = element_text(size=14, vjust = 1),
plot.title = element_text(size = 16, vjust = -1))
plot
}
testRisk(maine_risk)
testRisk <- function(risk_data) {
levels = length(risk_data)
df <- do.call("rbind", risk_data)
state = levels(df$state)
title <- paste("Invasion Risk Over Time for", state)
plot <- ggplot(df, aes(time, probability, col = level))
plot <- plot + geom_point() + geom_line() + ggtitle(title)
plot <- plot + xlab("Years") + ylab("Probability[Establishment > Level]")
plot <- plot + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), legend.background = element_blank(),
axis.line.x = element_line(colour = "black"),
axis.line = element_line(colour = "black"),
axis.text.y = element_text(size=10),
axis.text.x = element_text(size=10),
axis.title.y = element_text(size=14, vjust = 1),
axis.title.x = element_text(size=14, vjust = 1),
plot.title = element_text(size = 16, vjust = 1))
plot
}
testRisk(maine_risk)
level
generateRisk <- function(data, state, levels = c(0.1, 0.2, 0.5)) {
state_code <- which(states == state)
time_steps <- length(data[[1]])
num_levels <- length(levels)
num_runs <- length(data)
output_data <- list(0)
for(i in 1:num_levels) {
level = levels[i]
prob <- numeric(time_steps)
for(step in 1:time_steps) {
count = 0
for(run in 1:num_runs) {
current_run <- data[[run]][[step]][state_code]
if(current_run > level) {
count = count + 1
}
}
prob[step] <- count / num_runs
}
df <- data.frame(probability = prob, time = 1:time_steps, Level = as.factor(level),
state = state)
output_data[[i]] <- df
}
output_data
}
plotRisk <- function(init_state, target_state, times, steps,
growth = TRUE, levels = c(0.1, 0.2, 0.5)) {
initial <- rep(0, 51)
index <- which(states == init_state)
initial[index] <- 1                       #Creates the initial state vector
state_data <- runMany(initial, times, steps, w1, w2, w3, w4)
risk_data <- generateRisk(state_data, target_state, levels)
levels = length(risk_data)
df <- do.call("rbind", risk_data)
state = levels(df$state)
title <- paste("Invasion Risk Over Time for", state)
plot <- ggplot(df, aes(time, probability, col = level))
plot <- plot + geom_point() + geom_line() + ggtitle(title)
plot <- plot + xlab("Years") + ylab("Probability[Establishment > Level]")
plot
}
testRisk <- function(risk_data) {
levels = length(risk_data)
df <- do.call("rbind", risk_data)
state = levels(df$state)
title <- paste("Invasion Risk Over Time for", state)
plot <- ggplot(df, aes(time, probability, col = level))
plot <- plot + geom_point() + geom_line() + ggtitle(title)
plot <- plot + xlab("Years") + ylab("Probability[Establishment > Level]")
plot <- plot + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), legend.background = element_blank(),
axis.line.x = element_line(colour = "black"),
axis.line = element_line(colour = "black"),
axis.text.y = element_text(size=10),
axis.text.x = element_text(size=10),
axis.title.y = element_text(size=14, vjust = 1),
axis.title.x = element_text(size=14, vjust = 1),
plot.title = element_text(size = 16, vjust = 1))
plot
}
testRisk(maine_risk)
testRisk(maine_risk)
maine_risk <- generateRisk(maine_data)
maine_risk <- generateRisk(maine_data, "Illinois")
testRisk(maine_risk)
testRisk <- function(risk_data) {
levels = length(risk_data)
df <- do.call("rbind", risk_data)
state = levels(df$state)
title <- paste("Invasion Risk Over Time for", state)
plot <- ggplot(df, aes(time, probability, col = Level))
plot <- plot + geom_point() + geom_line() + ggtitle(title)
plot <- plot + xlab("Years") + ylab("Probability[Establishment > Level]")
plot <- plot + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), legend.background = element_blank(),
axis.line.x = element_line(colour = "black"),
axis.line = element_line(colour = "black"),
axis.text.y = element_text(size=10),
axis.text.x = element_text(size=10),
axis.title.y = element_text(size=14, vjust = 1),
axis.title.x = element_text(size=14, vjust = 1),
plot.title = element_text(size = 16, vjust = 1))
plot
}
illinois_data <- maine_data
testRisk(maine_data)
testRisk(maine_risk)
testRisk(generateRisk(maine_data, "Virginia"))
testRisk(generateRisk(maine_data, "Colorado"))
testRisk(generateRisk(maine_data, "Illinois"))
testRisk(generateRisk(maine_data, "Virginia"))
testRisk(generateRisk(maine_data, "New Hampshire"))
testRisk(generateRisk(maine_data, "New Mexico"))
testRisk(generateRisk(maine_data, "California"))
plotRisk <- function(init_state, target_state, times, steps,
growth = TRUE, levels = c(0.1, 0.2, 0.5)) {
initial <- rep(0, 51)
index <- which(states == init_state)
initial[index] <- 1                       #Creates the initial state vector
state_data <- runMany(initial, times, steps, w1, w2, w3, w4)
risk_data <- generateRisk(state_data, target_state, levels)
levels = length(risk_data)
df <- do.call("rbind", risk_data)
state = levels(df$state)
title <- paste("Invasion Risk Over Time for", state)
plot <- ggplot(df, aes(time, probability, col = Level))
plot <- plot + geom_point() + geom_line() + ggtitle(title)
plot <- plot + xlab("Years") + ylab("Probability[Establishment > Level]")
plot <- plot + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), legend.background = element_blank(),
axis.line.x = element_line(colour = "black"),
axis.line = element_line(colour = "black"),
axis.text.y = element_text(size=10),
axis.text.x = element_text(size=10),
axis.title.y = element_text(size=14, vjust = 1),
axis.title.x = element_text(size=14, vjust = 1),
plot.title = element_text(size = 16, vjust = 1))
plot
}
